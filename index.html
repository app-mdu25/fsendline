
<!DOCTYPE html>
<html lang="en">
<head>
<title>ฟอร์มแจ้งเตือนทางไลน์</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<base target="_top">
<link rel="icon" type="image/png" href="images/icons/favicon.ico" />

<link rel="stylesheet" type="text/css" href="vendor/bootstrap/css/bootstrap.min.css">

<link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.7.0/css/font-awesome.min.css">

<link rel="stylesheet" type="text/css" href="vendor/animate/animate.css">

<link rel="stylesheet" type="text/css" href="vendor/css-hamburgers/hamburgers.min.css">

<link rel="stylesheet" type="text/css" href="vendor/animsition/css/animsition.min.css">

<link rel="stylesheet" type="text/css" href="vendor/select2/select2.min.css">

<link rel="stylesheet" type="text/css" href="vendor/daterangepicker/daterangepicker.css">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<link rel="stylesheet" type="text/css" href="css/util.css">
<link rel="stylesheet" type="text/css" href="css/main.css">

<meta name="robots" content="noindex, follow">
</head>
<body>
<div class="container-contact100">
<div class="wrap-contact100">
<form id="myForm" class="contact100-form validate-form">
<span class="contact100-form-title">
แจ้งส่งข่าวทางไลน์!
</span>
<div class="wrap-input100 validate-input">
<span class="label-input100">เรื่อง</span>
<input class="input100" type="text" id="topic" name="topic" placeholder="ใส่เรื่องที่ส่ง">
<span class="focus-input100"></span>
</div>
<div class="wrap-input100 input100-select">
<span class="label-input100">ฝ่าย/แผนก</span>
<div>
<select class="selection-2" id="department" name="department">
<option>เลือกแผนก</option>
<option>ฝกพ.นพค.25</option>
<option>ฝยก.ขว.นพค.25</option>
<option>ฝกบ.นพค.25</option>
<option>ฝกร.นพค.25</option>
<option>นพช.นพค.25</option>
<option>นสน.นพค.25</option>
<option>จัดซื้อจัดจ้าง.นพค.25</option>
<option>ฝกง.นพค.25</option>
<option>ตสส.นพค.25</option>
<option>ช.พัฒนา นพค.25</option>
</select>
</div>
<span class="focus-input100"></span>
</div>
<div class="wrap-input100 validate-input">
<span class="label-input100">อัปโหลดไฟล์ข่าว</span>
<input class="form-control" type="file" id="fileUrl" name="fileUrl" multiple>
<span class="focus-input100"></span>
</div>

<div class="container-contact100-form-btn">
<div class="wrap-contact100-form-btn">
<div class="contact100-form-bgbtn"></div>
<button class="contact100-form-btn" type="submit">
<span>
Submit
<i class="fa fa-long-arrow-right m-l-7" aria-hidden="true"></i>
</span>
</button>
</div>
</div>
</form>
</div>
</div>
   <script>
      document.getElementById('myForm').addEventListener('submit', function(e) {
        e.preventDefault();

        var data = {
          department: document.getElementById('department').value,
          topic: document.getElementById('topic').value,
          fileUrl: document.getElementById('fileUrl').value
        };

        fetch('https://script.google.com/macros/s/AKfycbzapNhHd1JMCOV2G3Qz1XqZDvCqdClpkewrxz6KQrdyAE-Vu3PjU_P0JkrKC_2wATimeQ/exec', {
          method: 'POST',
          body: JSON.stringify(data),
          headers: {
            'Content-Type': 'application/json'
          }
        }).then(response => response.json())
          .then(response => {
            if (response.result === 'success') {
              Swal.fire({
                icon: 'success',
                title: 'สำเร็จ',
                text: 'ส่งข้อมูลเรียบร้อยแล้ว'
              });
            } else {
              Swal.fire({
                icon: 'error',
                title: 'เกิดข้อผิดพลาด',
                text: 'มีปัญหาในการส่งข้อมูล'
              });
            }
          }).catch(error => {
            Swal.fire({
              icon: 'error',
              title: 'เกิดข้อผิดพลาด',
              text: 'มีปัญหาในการส่งข้อมูล'
            });
          });
      });
    </script>

<script src="vendor/jquery/jquery-3.2.1.min.js"></script>

<script src="vendor/animsition/js/animsition.min.js"></script>

<script src="vendor/bootstrap/js/popper.js"></script>
<script src="vendor/bootstrap/js/bootstrap.min.js"></script>

<script src="vendor/select2/select2.min.js"></script>
<script>
		$(".selection-2").select2({
			minimumResultsForSearch: 20,
			dropdownParent: $('#dropDownSelect1')
		});
	</script>

<script src="vendor/daterangepicker/moment.min.js"></script>
<script src="vendor/daterangepicker/daterangepicker.js"></script>

<script src="vendor/countdowntime/countdowntime.js"></script>

<script src="js/main.js"></script>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-23581568-13"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-23581568-13');
</script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8a62b4168c382dbc","serverTiming":{"name":{"cfL4":true}},"version":"2024.7.0","token":"cd0b4b3a733644fc843ef0b185f98241"}' crossorigin="anonymous"></script>
</body>
</html>
